<head>
  <script>
    function updateItemStyleWithImageRatio(item) {
      let img = item.getElementsByTagName("img")[0];
      item.setAttribute("style", "--ratio: " + img.naturalWidth + " / " + img.naturalHeight);
    }

    function updateItems() {
      let rows = document.getElementsByClassName("item");
      for (let i = 0; i < rows.length; i++) {
        updateItemStyleWithImageRatio(rows[i]);
      }
      console.log("Elements updated.");
    }

    function addAnswerChecking(answers) {
      for (let i = 0; i < answers.length; i++) {
        let row = document.getElementById('q' + i);
        row.addEventListener("click", function () { checkAnswer(i, answers); });
      }
    }

    function checkAnswer(i, answers) {
      answer = prompt("Please type your answer to check it..").toLowerCase().trim();
      if (answers[i].includes(hash(answer))) {
        alert("ðŸŽ… Correct! Yippee ki yay!! ðŸ˜€");
        document.getElementById('q' + i).style.backgroundColor = "Green";
      }
      else {
        alert("Wrong ðŸ˜­(or one of us has spelled our answer wrong) Humbug. ðŸ‘¿");
      }
    }

    function getReady() {
      updateItems(); //Prepares CSS image spacing for full width, retaining aspect ratio.

      let hashedAnswers = [['gmlmbo', '1ek8zw5'], ['1cdex09', 'fgzckq'], ['uad0yq', '1iu3p8n', '680w3n'], ['1jlpbm'], ['1h3332f'], ['hhygxi', 'vp5qa0'], ['1n1ine', '1eub4pe'], ['1rcg4ez', 'gydwlv'], ['ci04is'], ['179j05d', '1m87nxk']];
      addAnswerChecking(hashedAnswers);
    }

    function hash(str) {
      /* A hashing funtion is a one-way function that gives an apparently random hash from a string input,
       * but you can't work out the string input from the hash. That's why it's one-way.
       * Sometimes 2 different inputs might give you the same hash. This is called a collision and is
       * undesirable.
       */ 
      // Thanks to https://gist.github.com/jlevy/c246006675becc446360a798e2b2d781
      // This is a simple, *insecure* hash that's short, fast, and has no dependencies.
      // For algorithmic use, where security isn't needed, it's way simpler than sha1 (and all its deps)
      // or similar, and with a short, clean (base 36 alphanumeric) result.
      // Loosely based on the Java version; see
      // https://stackoverflow.com/questions/6122571/simple-non-secure-hash-function-for-javascript
  
      let hash = 0;
      for (let i = 0; i < str.length; i++) {
        const char = str.charCodeAt(i);
        hash = (hash << 5) - hash + char;
        hash &= hash; // Convert to 32bit integer
      }
      return new Uint32Array([hash])[0].toString(36);
  }
  </script>
  <link rel="stylesheet" href="style.css">
</head>

<body onload="getReady();">
  <p>Say hello to my little charity Christmas quiz. This year, eat humbugs â€” each answer is an anti-xmas 'baddie'. Most of the answers are made up of the one- or two-syllable picture clues, which you put together to get the answer. Some of the clues are pretty ropey which is fine, I promise.</p>
  <p>Tips: get a diverse team if you want a good chance; after all, nobody knows about Christmas, rubbish AI films <em>and</em> persistent primary storage on a computer. Talk through your thoughts out loud with your family or friends or online and gasp as the answers emerge from your hive mind.</p>
  <p>To comment on the quiz and donate, moan (and donate), say thanks (and donate) or just donate, please do so <a href="https://www.justgiving.com/page/dave-edwards-1702151473425" target="_blank" rel="noopener noreferrer">here</a>. This year, any donations will go to UNHCR, so if you have a roof and food, then please consider chipping in.</p>
  <p>Please share far and wide on your WhatsApps, Discords, Exes and Facebooks etc.</p>
  <p>Dave ðŸŽ…</p>
  <p>PS please consider this your non-transferrable Christmas card.</p>
  
  <div id="q0" class="row">
    1
    <div class="item">
      <img src="transparent-spacer.png" alt="">
    </div>
    <div class="item">
      <img src="Tennel_Cheshire_proof-rule.png"
        alt="The Cheshire cat with a stainless steel rule superimposed on top. The face seems to be about 30 millimetres wide.">
    </div>
    <div class="item">
      <img src="transparent-spacer.png" alt="">
    </div>
  </div>
  <div id="q1" class="row">
    2
    <div class="item">
      <img src="love-still-around.png" alt="Love Is All Around has 33% buffered...">
    </div>
    <div class="item">
      <img src="bob-dylan-and-co.png" alt="A young Bob Dylan is recording with his fellow musicians.">
    </div>
    <div class="item">
      <img src="tim-curry-pennywise.jpg" alt="Tim Curry as a sinister clown.">
    </div>
    <div class="item">
      <img src="Bill-pennywise.png" alt="Bill SkarsgÃ¥rd is a younger and scarier version of the same clown.">
    </div>
  </div>
  <div id="q2" class="row">
    3
    <div class="item">
      <img src="mister.jpg" alt="Fine spraying device.">
    </div>
    <div class="item">
      <img src="tik-tok-ceramicist.webp" alt="Bespectacled student throuwing a pot on a wheel.">
    </div>
  </div>
  <div id="q3" class="row">
    4
    <div class="item">
      <img src="transparent-spacer.png" alt="">
    </div>
    <div class="item">
      <img src="MJ-album-father-christmas.png"
        alt="On a Black and white album cover, Michael Jackson is wearing a red hat.">
    </div>
    <div class="item">
      <img src="transparent-spacer.png" alt="">
    </div>
  </div>
  <div id="q4" class="row">
    5
    <div class="item">
      <img src="mr-solos-companions.png"
        alt="Abourd the Milleniun Falcon, Chewwy, Leia, C3P0 and Luke are circled, sat around the captain.">
    </div>
    <div class="item">
      <img src="sharp-edges-on-metal.webp"
        alt="Someone should rub the dangerous jagged edge of this machined piece of metal.">
    </div>
  </div>
  <div id="q5" class="row">
    6
    <div class="item">
      <img src="convex-meniscus.png" alt="A glass with water to the brim.">
    </div>
    <div class="item">
      <img src="1000kg-weight.png" alt="A metal 1000kg weight.">
    </div>
    <div class="item">
      <img src="what-colour.png" alt="RGB Colour wheel with #00ff00 indicated.">
    </div>
    <div class="item">
      <img src="cheese-separation.png" alt="The liquid section of a cheese manufacturing process is indicated.">
    </div>
  </div>
  <div id="q6" class="row">
    7
    <div class="item">
      <img src="film-with-scarlett-phoenix.jpg"
        alt="Film still where Joaquin Phoenix's character is having an earnest conversation with a scarlett computer screen.">
    </div>
    <div class="item">
      <img src="inanimate-carbon-hero.jpg" alt="Inanimate carbon cylinder receiving an adulatory parade.">
    </div>
  </div>
  <div id="q7" class="row">
    8
    <div class="item">
      <img src="transparent-spacer.png" alt="">
    </div>
    <div class="item">
      <img src="miaoww.png" alt="Cat footballer having lactic acid stretched out.">
    </div>
    <div class="item">
      <img src="transparent-spacer.png" alt="">
    </div>
  </div>
  <div id="q8" class="row">
    9
    <div class="item">
      <img src="ms-oil.png" alt="Popeye the sailor and Bluto compete to woo her.">
    </div>
    <div class="item">
      <img src="not-baltimores-finest-narc.png"
        alt="Baltimore's finest fictional cops. Carver's incompetent bald partner is indicated.">
    </div>
    <div class="item">
      <img src="chip-with-data.jpg" alt="A computer chip with C64 BASIC written onto it permanently.">
    </div>
    <div class="item">
      <img src="water-collection-shaft.jpg" alt="Chief Wiggum can't fit down the shaft of this to save Timmy O'Toole.">
    </div>
  </div>
  <div id="q9" class="row">
    10
    <div class="item">
      <img src="ERB.webp"
        alt="England women's first black player, world cup winner, and Lambeth and Surrey legend is probably talking sense into her mic.">
    </div>
    <div class="item">
      <img src="french-pianist.png" alt="Coolish black-and-white album cover featuring a smoking old pianiste.">
    </div>
    <div class="item">
      <img src="cool-stunt-bro-2.png" alt="A 60-something actor is doing a stunt hanging from a chopper.">
    </div>
  </div>
  <footer><p>Thanks to everyone who has helped, especially the Y13 A-level class, <a href="https://9elements.com/blog/building-a-combined-css-aspect-ratio-grid/">Nils Binder</a> and <a href="https://www.shecodes.io/athena/22284-how-to-scale-images-with-different-sizes-in-a-css-grid#:~:text=If%20your%20pictures%20have%20different,resized%20to%20fit%20its%20container.">shecodes' Athena</a> for their sweet CSS which I have stolen and mangled, and the non-litigious and laudably charitable photographers and film studios. Issues etc, please go to the GitHub <a href="https://github.com/LudlowCode/anti-xmas">repo</a>.</p></footer>
</body>